<!DOCTYPE html>
<html>
  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <meta property="og:title" content="25-DIOP: Disallow Deployment of Unused Opcodes">
  
  <meta property="og:site_name" content="Ethereum Classic Improvement Proposals">
  <meta name="author" content="Wei Tang">

  
  <meta property="og:type" content="article">
  <meta property="article:published_time" content="2019-03-19T09:23:20+01:00">
  

  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="25-DIOP: Disallow Deployment of Unused Opcodes">
  
  <meta name="twitter:site" content="@sorpaas">

  <title>
    
      25-DIOP: Disallow Deployment of Unused Opcodes &middot; Ethereum Classic Improvement Proposals
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/styles.css">
</head>

  <body>
    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p><p>Collections of Ethereum Classic Improvement Proposals</p>
</p>
  </div>

  <nav class="sidebar-nav">
    

    <a class="sidebar-nav-item" href="/">
      Home
      </a>
    
    
    
    
    <a class="sidebar-nav-item" href="/raw/">Raw</a>
    
    
    
    <a class="sidebar-nav-item" href="/draft/">Draft</a>
    
    
    
    <a class="sidebar-nav-item" href="/stable/">Stable</a>
    
    
    
    <a class="sidebar-nav-item" href="/deprecated/">Deprecated</a>
    
    
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2019.
      All rights reserved.
      
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      

<div class="container content">
  <div class="page-header">
    <div class="row">
      <h1>25-DIOP</h1>
      <p>Disallow Deployment of Unused Opcodes</p>

      <table>
        <tr><th>URI</th><td>ecips.that.world/25-DIOP</td></tr>
        <tr><th>Author</th><td>Wei Tang &lt;hi@that.world&gt;</td></tr>
        
        <tr><th>Discussions-To</th><td><a href="https://github.com/sorpaas/EIPs/issues/4">https://github.com/sorpaas/EIPs/issues/4</a></td></tr>
        
        <tr><th>Status</th><td>Raw</td></tr>
        <tr><th>Type</th><td>Standard Track</td></tr>
        
        <tr><th>Category</th><td>Core</td></tr>
        
        
        <tr><th>Created</th><td>2019-01-19</td></tr>
        
        
        
        
        
      </table>
    </div>
  </div>

  <div class="page-content">
    <h2 id="simple-summary">Simple Summary</h2>

<p>Hard fork can change existing contract behavior. One of the point can
be raised about adding new opcodes is that it modifies existing unused
opcodes from throwing out of gas to another behavior. While we can
mostly argue that deploying unused opcode is not of much use so no
sane developers would do that, it would be better to just disallow
deployment of unused opcodes.</p>

<h2 id="specification">Specification</h2>

<p>After <code class="highlighter-rouge">HARD_FORK</code> number, before executing a contract creation
transaction, or adding contract code to the state, do the following
check:</p>

<ul>
  <li>Iterate over the code bytes one by one.
    <ul>
      <li>If the code byte is a PUSH(n) opcode, skip next n bytes.</li>
      <li>If the code byte is a valid opcode or designated invalid
instruction (<code class="highlighter-rouge">0xfe</code>), continue.</li>
      <li>Otherwise, throw out-of-gas.</li>
    </ul>
  </li>
</ul>

<p>Note that this check is similar to jump destination checks.</p>

  </div>

  <footer class="footer">
  <small>
    
    <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFAAAAAPCAMAAABEF7i9AAAAllBMVEUAAAD///+rsapERER3d3eIiIjMzMzu7u4iIiKUmZO6v7rKzsoODg4RERFVVVUNDQ0NDg0PEA8zMzNLTEtbXltmZmZydnF9gn2AgICPkI+ZmZmqqqq7u7vFxsXIzMgNDQwZGRkgICAhISEkJSMnKCcuMC4xMzE5Ozk7PTtBQkFCQkJDQ0Nna2eGhoaHh4ezuLLGysbd3d1wVGpAAAAA0klEQVR42q2T1xbCIAyGk0CXdlmto3XvPd7/5QRL1432WHI4XED4+PMHALQHag0JJBlXMNQScx2ibu9PdTnQcY3iErYl6oxbAo/rUrUJA6J5vx0wNNC0gVkMbBPZXtQ8Uf6qpNJwOf0EjmCKto+ce1aSIg9FzTO1/xlYyVeL34FDMC3ZFT+SNXOX6PEsBKm0rIOYPYuGClnsWTxBHtQV1gRhI4UUGJh6EAsPoxdedjUPK+dzT38DDyvNXXYW9wJ43mh4h6ItN8U7Ldv+FN1/WXO8Aed5CQIgC4KiAAAAAElFTkSuQmCC" /></a>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    
    </small>
</footer>

</div>

    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
     (function(document) {
       var toggle = document.querySelector('.sidebar-toggle');
       var sidebar = document.querySelector('#sidebar');
       var checkbox = document.querySelector('#sidebar-checkbox');

       document.addEventListener('click', function(e) {
         var target = e.target;

         if(!checkbox.checked ||
            sidebar.contains(target) ||
            (target === checkbox || target === toggle)) return;

         checkbox.checked = false;
       }, false);
     })(document);
    </script>

  </body>
</html>
